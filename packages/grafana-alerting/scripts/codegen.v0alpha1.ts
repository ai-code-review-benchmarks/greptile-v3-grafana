/**
 * This script will generate TypeScript type definitions and a RTKQ client for the alerting k8s APIs.
 * It downloads the OpenAPI schema from a running Grafana instance and generates the types.
 *
 * Run `yarn run codegen` from the "grafana-alerting" package to invoke this script.
 */
import type { ConfigFile } from '@rtk-query/codegen-openapi';
import { resolve } from 'node:path';

const VERSION = 'v0alpha1' as const;

export default {
  // we append the version here so we export versioned API clients
  exportName: 'alertingAPI' + VERSION,
  // ℹ️ these snapshots are generated by running "go test pkg/tests/apis/openapi_test.go",
  // see the README in the "openapi_snapshots" directory
  schemaFile: resolve(`../../../pkg/tests/apis/openapi_snapshots/notifications.alerting.grafana.app-${VERSION}.json`),
  // ⚠️ all API endpoints will use a versioned API client to prevent cache bugs
  apiFile: `../src/grafana/api/api.${VERSION}.ts`,
  // output versioned API client
  outputFile: resolve(`../src/grafana/api/api.${VERSION}.gen.ts`),
  // generate tags for cache invalidation
  tag: true,
} satisfies ConfigFile;
