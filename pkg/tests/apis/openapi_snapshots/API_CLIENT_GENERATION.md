This folder contains a rendered OpenAPI file for each group/version. The “real” OpenAPI is generated by the running server, but the files here are used to build static frontend clients.

## Generate RTK API Clients

To show the steps to follow we are going to work on adding an API client for creating a new dashboard. Just addapt the following guide to your use case.

### 1.Specify `group` and `version`
First check if the `group` and the `version` are already created in [openapi_test.go](https://github.com/grafana/grafana/blob/main/pkg/tests/apis/openapi_test.go). 
<br/> If you need to add a new block, you can check for the right `group` and `version` in the backend api call that you want to replicate in the frontend.

```jsx
{
    Group:   "dashboard.grafana.app",
	Version: "v0alpha1",
}
```
### 2. Run the `TestIntegrationOpenAPIs` test
Note that it will fail the first time you run it and, in the second one, it will generate the corresponding OpenAPI spec. You will find it in [openapi_snapshots](https://github.com/grafana/grafana/blob/main/pkg/tests/apis/openapi_snapshots).
<br/>
<br/>

> Note: You won't need to follow these two steps if the `group` you will work within is already in the `openapi_test.go` file.

<br/>

### 3. Create the API definition
In the folder `../public/app/features/{your_group_name}/api/` you have to create the `baseAPI.ts` file for your group. This file should have the following content:

```jsx
import { createApi } from '@reduxjs/toolkit/query/react';

import { createBaseQuery } from 'app/api/createBaseQuery';
import { getAPIBaseURL } from 'app/api/utils';

export const BASE_URL = getAPIBaseURL('dashboard.grafana.app', 'v0alpha1');

export const baseAPI = createApi({
  reducerPath: 'dashboardAPI',
  baseQuery: createBaseQuery({
    baseURL: BASE_URL,
  }),
  endpoints: () => ({}),
});
```
This is the API definition for the specific group you're working with, where `getAPIBaseURL` should have the proper `group` and `version` as parameters. The `reducePath` should also be modified to match `group + API`: `dashboard` will be `dashboardAPI`, `iam` will be `iamAPI` and so on. 

### 4. Add the output information
Open [generate-rtk-apis.ts](https://github.com/grafana/grafana/blob/main/scripts/generate-rtk-apis.ts) and add the following information:

| Data | Descritpion |
|------|-------------|
| outputFile name | File that will be created after running the API Client Generation script. It is the key of the object. | 
| apiFile | File with the API definition for the group. |
| schemaFile | File with the schema that was automatically created in the second step. Although it is in openapi_snapshots, you should link the one saved in `data/openapi`.|
|apiImport| Function name exported in the API definition (baseAPI.ts file).|
| filterEndpoints | The `operationId` of the particular route you want to work with. You can check the available operationIds in the specific spec file for the group. As seen in the `migrate-to-cloud`one, it is an array|
| argSuffix | |
| responseSuffix | |
| tag | |
| hooks | |

> More info in [Redux Toolkit](https://redux-toolkit.js.org/rtk-query/usage/code-generation#simple-usage) 

In our example the information added will be:

```jsx
'../public/app/features/dashboard/api/endpoints.gen.ts': {
    apiFile: '../public/app/features/dashboard/api/baseAPI.ts',
    schemaFile: '../data/openapi/dashboard.grafana.app-v0alpha1.json',
    apiImport: 'baseAPI',
    filterEndpoints: ['createDashboard'],
    argSuffix: 'Arg',
    responseSuffix: 'Response',
    tag: true,
    hooks: true,
},
```

### 5. Run the API Client script
Then we are ready to run the script to create the API client:

```jsx
yarn generate-apis
```

This will create an `endpoints.gen.ts` file in the path specified in the previous step.